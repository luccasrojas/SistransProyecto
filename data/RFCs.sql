
--RFC1 (par�metros = fechaInf, fechaSup)
--CuentaServicio
SELECT RESERVA_HABITACION.NOMBRE_HOTEL,RESERVA_HABITACION.NUMERO_HABITACION,SUM(D.SC)
FROM RESERVA_HABITACION INNER JOIN
    (SELECT ID_RESERVA_HABITACION,SUM(COSTO) SC
    FROM CUENTA_SERVICIO
    WHERE FECHA >= fechaInf AND FECHA <= fechaSup
    GROUP BY ID_RESERVA_HABITACION) D ON D.ID_RESERVA_HABITACION = RESERVA_HABITACION.ID_RESERVA_HABITACION
GROUP BY RESERVA_HABITACION.NOMBRE_HOTEL,RESERVA_HABITACION.NUMERO_HABITACION
ORDER BY RESERVA_HABITACION.NOMBRE_HOTEL,RESERVA_HABITACION.NUMERO_HABITACION;

--RFC2 (par�metros = fechaInf, fechaSup)
--CuentaServicio
SELECT TIPO_SERVICIO
FROM SERVICIO INNER JOIN (
    SELECT ID_SERVICIO, COUNT(*) AS CONTEO
    FROM CUENTA_SERVICIO
    WHERE FECHA >= fechaInf AND FECHA <= fechaSup
    GROUP BY ID_SERVICIO
    ) A ON SERVICIO.ID_SERVICIO = A.ID_SERVICIO
ORDER BY A.CONTEO DESC
FETCH FIRST 20 ROWS ONLY;

SELECT * FROM RESERVA_HABITACION;

--RFC3 (par�metros = nombreHotel, fechaInf, fechaSup)
--Habitacion
SELECT HABITACION.NOMBRE_HOTEL,HABITACION.NUMERO,COUNT(*)
FROM HABITACION LEFT OUTER JOIN
    (SELECT NOMBRE_HOTEL,NUMERO_HABITACION,FECHA_IN,FECHA_OUT
    FROM RESERVA_HABITACION
    WHERE NOMBRE_HOTEL = nombreHotel)C ON HABITACION.NUMERO = C.NUMERO_HABITACION AND HABITACION.NOMBRE_HOTEL = nombreHotel
WHERE C.FECHA_IN >= fechaInf AND C.FECHA_IN <= fechaSup
GROUP BY HABITACION.NOMBRE_HOTEL,HABITACION.NUMERO;

--RFC4 (par�metro = condicion)
--CuentaServicio
SELECT SERVICIO.*
FROM CUENTA_SERVICIO INNER JOIN SERVICIO ON SERVICIO.ID_SERVICIO = CUENTA_SERVICIO.ID_SERVICIO
WHERE condicion;

--RFC5 (par�metros = tipoDocumento, numDocumento, fechaInf, fechaSup)
--HuespedReserva
SELECT CUENTA_SERVICIO.ID_SERVICIO,CUENTA_SERVICIO.FECHA,CUENTA_SERVICIO.CONCEPTO,CUENTA_SERVICIO.COSTO
FROM CUENTA_SERVICIO INNER JOIN
    (SELECT ID_RESERVA_HABITACION
    FROM HUESPED_RESERVA
    WHERE TIPO_DOCUMENTO = tipoDocumento AND NUMERO_DOCUMENTO = numDocumento)B ON B.ID_RESERVA_HABITACION = CUENTA_SERVICIO.ID_RESERVA_HABITACION
WHERE CUENTA_SERVICIO.FECHA >= fechaInf AND CUENTA_SERVICIO.FECHA <= fechaSup;
